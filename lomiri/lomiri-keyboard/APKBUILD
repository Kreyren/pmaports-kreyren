# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=lomiri-keyboard
pkgver=0_git20230421
_commit="f8c368dd049ed5343a9d5c8e4c1a1abd89998e36"
pkgrel=0
pkgdesc="Ubuntu Touch keyboard as maliit plugin"
url="https://gitlab.com/ubports/development/core/lomiri-keyboard"
arch="all"
license="LGPL-3.0-only AND BSD-3-Clause"
makedepends="qt5-qtbase-dev maliit-framework-dev libpinyin-dev gsettings-qt-dev hunspell-dev presage-dev anthy-dev libchewing-dev"
checkdepends="xvfb-run bash"
subpackages="$pkgname-dev $pkgname-lang"
source="https://gitlab.com/ubports/development/core/lomiri-keyboard/-/archive/$_commit/lomiri-keyboard-$_commit.tar.gz
	0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
	"
builddir="$srcdir/$pkgname-$_commit"

build() {
	qmake-qt5 PREFIX=/usr
	make
}

check() {
	xvfb-run -a make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
	install -Dm644 debian/server.conf "$pkgdir"/etc/xdg/maliit.org/server.conf
}

sha512sums="
e5fcaa3ee5a0ad6fb469323e529ffdf31a045a7fb7eb183e20e282e835b395c72ea891b266b0cd2bfe8d6cccc58a7c1ddaa462a3c95d587f6bc33afd3660be5e  lomiri-keyboard-f8c368dd049ed5343a9d5c8e4c1a1abd89998e36.tar.gz
74082639d95838c1a2c60007160140c008e68086fd09e5e4b4b6b6ca63eaa2d8f58ce4b8a0a9c650664fb06bef698a1e64c5cbe499f619853c5eaca9e3807afd  0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
"
