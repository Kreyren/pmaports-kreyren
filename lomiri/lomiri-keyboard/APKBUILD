# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=lomiri-keyboard
pkgver=0_git20230131
_commit="9ee1c9cb4f123e4e04def79ef10c10c2a29eeb4d"
pkgrel=0
pkgdesc="Ubuntu Touch keyboard as maliit plugin"
url="https://gitlab.com/ubports/development/core/lomiri-keyboard"
arch="all"
license="LGPL-3.0-only AND BSD-3-Clause"
makedepends="qt5-qtbase-dev maliit-framework-dev libpinyin-dev gsettings-qt-dev hunspell-dev presage-dev anthy-dev libchewing-dev"
checkdepends="xvfb-run bash"
subpackages="$pkgname-dev $pkgname-lang"
source="https://gitlab.com/ubports/development/core/lomiri-keyboard/-/archive/$_commit/lomiri-keyboard-$_commit.tar.gz
	0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
	"
builddir="$srcdir/$pkgname-$_commit"

build() {
	qmake-qt5 PREFIX=/usr
	make
}

check() {
	xvfb-run -a make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
	install -Dm644 debian/server.conf "$pkgdir"/etc/xdg/maliit.org/server.conf
}

sha512sums="
be05a06d6289ba9a86110a3703e2732db0038da577d928b8bdb967f235c1d36f706a1e974774b85366f403ac6d2e4a5aa8baefc62667a7c45fafec0d173bc001  lomiri-keyboard-9ee1c9cb4f123e4e04def79ef10c10c2a29eeb4d.tar.gz
74082639d95838c1a2c60007160140c008e68086fd09e5e4b4b6b6ca63eaa2d8f58ce4b8a0a9c650664fb06bef698a1e64c5cbe499f619853c5eaca9e3807afd  0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
"
