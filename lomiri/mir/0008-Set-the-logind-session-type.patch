From fba879a85a6a1df1a60cb410d9eae9f40ba87244 Mon Sep 17 00:00:00 2001
From: Alan Griffiths <alan@octopull.co.uk>
Date: Tue, 14 Feb 2023 14:39:26 +0000
Subject: [PATCH 8/8] Set the logind session type

---
 src/server/console/logind_console_services.cpp | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/server/console/logind_console_services.cpp b/src/server/console/logind_console_services.cpp
index 9583f40031..15f127ab2c 100644
--- a/src/server/console/logind_console_services.cpp
+++ b/src/server/console/logind_console_services.cpp
@@ -266,6 +266,11 @@ mir::LogindConsoleServices::LogindConsoleServices(std::shared_ptr<mir::GLibMainL
                 std::string{"Logind TakeControl call failed: "} + error_msg}));
     }
 
+    if (!logind_session_call_set_type_sync(session_proxy.get(), "wayland", nullptr, &error))
+    {
+        mir::log_debug("Failed to set logind session type: %s", error ? error->message : "unknown error");
+    }
+
     g_signal_connect(
         G_OBJECT(session_proxy.get()),
         "notify::active",
-- 
2.39.1

