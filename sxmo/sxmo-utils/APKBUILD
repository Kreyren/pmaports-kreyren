# Maintainer: Miles Alan <m@milesalan.com>
pkgname=sxmo-utils
pkgver=1.1.11
pkgrel=1
pkgdesc="Utility scripts, programs, and configs that hold the Sxmo UI environment together"
url="https://git.sr.ht/~mil/sxmo-utils"
arch="all"
license="MIT"
makedepends="libx11-dev xproto linux-headers"
depends="
	sxmo-dmenu
	sxmo-dwm
	sxmo-st
	sxmo-surf
	sxmo-svkbd

	alsa-utils
	autocutsel
	codemadness-frontends
	conky
	coreutils
	curl
	dunst
	ffmpeg
	gawk
	geoclue
	grep
	inotify-tools
	lisgd
	mediainfo
	modemmanager
	mpv
	ncurses
	sfeed
	sxiv
	terminus-font
	tzdata
	v4l-utils
	vis
	w3m
	xclip
	xdotool
	xdpyinfo
	xinput
	xprop
	xrandr
	xrdb
	xsel
	xset
	xsetroot
	xwininfo
	youtube-dl
"

options="suid !check" # has no tests
source="$pkgname-$pkgver.tar.gz::https://git.sr.ht/~mil/sxmo-utils/archive/$pkgver.tar.gz
	0001-enable-bluetooth-and-modem-drivers-during-crust-susp.patch
	"
install="$pkgname.post-install $pkgname.pre-deinstall"

package() {
	mkdir -p "$pkgdir/etc/modules-load.d/"
	printf %b "snd-aloop" > "$pkgdir/etc/modules-load.d/sxmo.conf"
	mkdir -p "$pkgdir/etc/modprobe.d/"
	printf %b "options snd slots=,snd-aloop" > "$pkgdir/etc/modprobe.d/sxmo.conf"

	make  -C "$builddir" PREFIX=$pkgdir install
	chmod u+s $pkgdir/usr/bin/sxmo_setpineled
	chmod u+s $pkgdir/usr/bin/sxmo_setpinebacklight
	chmod u+s $pkgdir/usr/bin/sxmo_screenlock
}

sha512sums="e1a23a0899f5a6bc25a3fe0d20401ccb218b6f0150f3cc06dda822c81075af9b08d59b310acf1310844c44b0adc0f1973c3d0a74ea53c4e7d8e1ab2132eb1684  sxmo-utils-1.1.11.tar.gz
7afe015b5f7a0c6fb644f0268d5558e02ee4d141d0c7f6167ce262c42e2ca767d7b4cdd9fc5cc52ca516bbbbb513d720fec5fd70269ef93f1511d5b6e6017fbd  0001-enable-bluetooth-and-modem-drivers-during-crust-susp.patch"
