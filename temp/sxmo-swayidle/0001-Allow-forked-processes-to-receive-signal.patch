From 47d3d61f406636d65d2830e6e429946cb63329cd Mon Sep 17 00:00:00 2001
From: Stacy Harper <contact@stacyharper.net>
Date: Sat, 8 Jan 2022 13:35:38 +0100
Subject: [PATCH] Allow forked processes to receive signal

Signed-off-by: Stacy Harper <contact@stacyharper.net>
---
 main.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/main.c b/main.c
index a33d646..9ea3f0b 100644
--- a/main.c
+++ b/main.c
@@ -147,6 +147,13 @@ static void cmd_exec(char *param) {
 			pid = fork();
 		}
 		if (pid == 0) {
+			sigset_t set;
+			sigemptyset(&set);
+			sigprocmask(SIG_SETMASK, &set, NULL);
+			signal(SIGINT, SIG_DFL);
+			signal(SIGTERM, SIG_DFL);
+			signal(SIGUSR1, SIG_DFL);
+
 			char *const cmd[] = { "sh", "-c", param, NULL, };
 			execvp(cmd[0], cmd);
 			swayidle_log_errno(LOG_ERROR, "execve failed!");
-- 
2.34.1

