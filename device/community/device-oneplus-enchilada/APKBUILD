# Reference: <https://postmarketos.org/devicepkg>
# Maintainer: Caleb Connolly <caleb@connolly.tech>

_codename=oneplus-enchilada
# TODO: allow using variables for pkgname
pkgname=device-oneplus-enchilada
pkgdesc="OnePlus 6"
pkgver=5
pkgrel=0
url="https://postmarketos.org"
license="MIT"
arch="aarch64"
options="!check !archcheck"
depends="
	linux-postmarketos-qcom-sdm845
	mkbootimg
	postmarketos-base
	postmarketos-update-kernel
	soc-qcom-sdm845
	soc-qcom-sdm845-ucm
"
makedepends="devicepkg-dev"
source="deviceinfo.oneplus-enchilada"
subpackages="
	$pkgname-nonfree-firmware:nonfree_firmware
"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	install -Dm644 "$srcdir/deviceinfo.$_codename" \
	"$pkgdir/etc/deviceinfo.$_codename"
}

nonfree_firmware() {
	pkgdesc="GPU, venus, modem firmware"
	depends="firmware-oneplus-sdm845"
	mkdir "$subpkgdir"
}

sha512sums="
03c4509760b782779ad1900c1695058b73e711de516e13103100176bb8ffb3618e445f1ce1a3fc20ea6609517ffd9e92b4f6b6f1fad8fc5f1ba893c56fc784fa  deviceinfo.oneplus-enchilada
"
