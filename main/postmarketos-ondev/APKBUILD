# Maintainer: Oliver Smith <ollieparanoid@postmarketos.org>
pkgname=postmarketos-ondev
pkgver=2.0.0
pkgrel=1
pkgdesc="Next-gen on-device installer (pmOS specific build)"
url="https://gitlab.com/postmarketOS/ondev2/"
arch="all"
license="GPL-3.0-or-later"
depends="
	$pkgname-lang
	dosfstools
	"
subpackages="$pkgname-lang"
source="https://gitlab.com/postmarketOS/ondev2/-/archive/$pkgver/ondev2-$pkgver.tar.gz"
options="!check"  # has no tests
makedepends="
	cryptsetup-dev
	eudev-dev
	gettext-tiny
	inih-dev
	libdrm-dev
	libinput-dev
	libxkbcommon-dev
	linux-headers
	meson
	musl-libintl
	pkgconf
	util-linux-dev
"
install="$pkgname.pre-install"

build() {
	abuild-meson -Ddistro=postmarketOS . output
	meson compile ${JOBS:+-j ${JOBS}} -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
"
